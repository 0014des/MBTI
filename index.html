<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBTI簡易診断</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container welcome-screen">
        <h1>MBTI簡易診断</h1>
        <p>あなたの性格タイプを診断しましょう！</p>
        <div class="level-selection">
            <h2>診断レベルを選択してください</h2>
            <h3>
            <a href="beginner.html" class="btn level-btn">初級 (20問)</a>
            <a href="intermediate.html" class="btn level-btn">中級 (40問)</a>
            <a href="advanced.html" class="btn level-btn">上級 (60問)</a>
        </div>

        <button id="toggle-history-btn" class="btn back-to-home-btn">診断履歴を表示</button>

        <div id="history-section" class="hidden"> <!-- 初期状態で非表示 -->
            <h2 class="history-title">過去の診断履歴</h2>
            <div id="history-list">
                <!-- 履歴はJavaScriptでここに挿入されます -->
            </div>
        </div>

        <!-- 利用規約へのリンクを追加 -->
        <div class="footer-links">
            <a href="terms.html" class="text-link">利用規約</a>
        </div>
    </div>

    <script>
        // index.html用の履歴表示ロジック
        function displayHistoryForIndex() {
            const historyListElem = document.getElementById("history-list");
            const history = JSON.parse(localStorage.getItem("mbtiHistory") || "[]");
            historyListElem.innerHTML = ""; // 既存の内容をクリア

            if (history.length === 0) {
                historyListElem.innerHTML += "<p>診断履歴はありません。</p>";
                return;
            }
            const ul = document.createElement("ul");
            history.forEach(item => {
                const li = document.createElement("li");
                li.textContent = `${item.date}: ${item.name} - ${item.type}`;
                ul.appendChild(li);
            });
            historyListElem.appendChild(ul);
        }

        document.addEventListener("DOMContentLoaded", () => {
            // --- ここから追加 ---
            // ---------------------------------
            // サウンドの読み込みとイベント設定
            // ---------------------------------
            const menuSound = new Audio('sound/menu.mp3'); // 難易度選択の音
            const clickSound = new Audio('sound/click.mp3'); // 履歴表示ボタンの音

            // 難易度選択ボタンにサウンドを追加
            const levelLinks = document.querySelectorAll('.level-btn');
            levelLinks.forEach(link => {
                link.addEventListener('click', function(event) {
                    event.preventDefault(); // リンク移動を一旦停止
                    menuSound.play(); // 音を再生
                    const destination = this.href;
                    setTimeout(() => { // 音が鳴るのを待ってから移動
                        window.location.href = destination;
                    }, 300); // 0.3秒後に移動
                });
            });
            // --- ここまで追加 ---


            displayHistoryForIndex(); // ページロード時に履歴を読み込み
            const toggleHistoryBtn = document.getElementById("toggle-history-btn");
            const historySection = document.getElementById("history-section");

            toggleHistoryBtn.addEventListener("click", () => {
                clickSound.play(); // ←★この行を追加
                historySection.classList.toggle("hidden"); // hiddenクラスをトグル
                if (historySection.classList.contains("hidden")) {
                    toggleHistoryBtn.textContent = "診断履歴を表示";
                } else {
                    toggleHistoryBtn.textContent = "診断履歴を隠す";
                    displayHistoryForIndex(); // 表示時に最新の履歴を再読み込み
                }
            });
        });
    </script>
</body>
</html>